/*
  Функция Substring проверяет, является ли ее первый аргумент подстрокой второго.
  Тест ленивого исполнения.
*/

$ENTRY Go {
 (e.x) e.y = <Substring (e.x) e.y>;
}

Substring {
    ()   e.y  = 'T';
    ('A' e.x) = 'F';
    ('B' e.x) = 'F';
    ('A' e.x) 'A' e.y = <LogOr <Prefix (e.x) e.y> <Substring ('A' e.x) e.y>>;
    ('B' e.x) 'B' e.y = <LogOr <Prefix (e.x) e.y> <Substring ('A' e.x) e.y>>;
    ('A' e.x) 'B' e.y = <Substring ('A' e.x) e.y>;
    ('B' e.x) 'A' e.y = <Substring ('B' e.x) e.y>;
}

LogOr {
    'T' e.1 = 'T';
    e.1 'T' = 'T';
    'FF'    = 'F';
}

Prefix {
    () e.y = 'T';
    ('A' e.x) 'A' e.y = <Prefix (e.x) e.y>;
    ('B' e.x) 'B' e.y = <Prefix (e.x) e.y>;
    ('A' e.x) 'B' e.y = 'F';
    ('B' e.x) 'A' e.y = 'F';
    ('A' e.x) = 'F';
    ('B' e.x) = 'F';
}
